@startuml GeoBeat Architecture
!theme vibrant
skinparam backgroundColor #FEFEFE
skinparam defaultTextAlignment center
skinparam ArrowColor #2C3E50
skinparam ArrowThickness 2
skinparam rectangleBackgroundColor #3498DB
skinparam rectangleBorderColor #2980B9
skinparam packageBorderColor #34495E
skinparam packageFontSize 14
skinparam packageFontStyle bold
left to right direction

title GeoBeat: Geographic Decentralization Index\nSystem Architecture Flow

' Define all layers as thin vertical columns
rectangle "Data Sources" <<layer>> #E8F8F5 {
  rectangle "Blockchain\nNodes" as nodes #58D68D
  rectangle "Public APIs" as apis #58D68D
  rectangle "P2P Crawlers" as p2p #58D68D
  rectangle "Staking\nProviders" as staking #58D68D
}

rectangle "Collection" <<layer>> #EBF5FB {
  rectangle "Network\nScrapers" as scrapers #5DADE2
  rectangle "Geolocation\nEnrichment" as geolocation #5DADE2
}

rectangle "Storage" <<layer>> #FEF9E7 {
  database "Raw Data\n(S3)" as raw #F4D03F
  database "Onchain\n(EAS/IPFS)" as onchain #F4D03F
  database "PostgreSQL" as postgres #F4D03F
  database "TimescaleDB" as timeseries #F4D03F
}

rectangle "Processing" <<layer>> #FDF2E9 {
  rectangle "Cleaning &\nValidation" as cleaning #EB984E
  rectangle "Aggregation\n(Geo/ASN)" as aggregation #EB984E
  rectangle "GDI Metrics" as metrics #E67E22
}

rectangle "Analytics" <<layer>> #F4ECF7 {
  rectangle "Comparative\nAnalysis" as comparison #AF7AC5
  rectangle "Risk\nAssessment" as risk #AF7AC5
}

rectangle "API" <<layer>> #E8F6F3 {
  rectangle "REST" as rest #48C9B0
  rectangle "GraphQL" as graphql #48C9B0
  rectangle "WebSocket" as websocket #48C9B0
}

rectangle "Dashboard" <<layer>> #FEF5E7 {
  rectangle "Interactive\nMaps" as maps #F8C471
  rectangle "Metric\nVisuals" as charts #F8C471
  rectangle "Filters" as filters #F8C471
  rectangle "Reports" as details #F8C471
}

' Data flow connections
nodes -right-> scrapers
apis -right-> scrapers
p2p -right-> scrapers
staking -right-> scrapers

scrapers -right-> raw
geolocation -right-> onchain

raw -right-> postgres
onchain -right-> postgres
postgres -right-> timeseries

timeseries -right-> cleaning
cleaning -right-> aggregation
aggregation -right-> metrics

metrics -right-> comparison
metrics -right-> risk

comparison -right-> rest
risk -right-> rest
comparison -right-> graphql
risk -right-> graphql

rest -right-> maps
graphql -right-> charts
websocket -right-> maps

maps -right-> filters
charts -right-> filters
filters -right-> details

note bottom of staking
**Supported Networks:**
Bitcoin, Ethereum, Solana, Polkadot
Cosmos, Avalanche, Cardano, Algorand
ATProto, EAS, IPFS, Filecoin
end note

note bottom of metrics
**Core Metrics:**
• Nakamoto Coefficient
• Gini Coefficient
• HHI Index
• Shannon Entropy
• Regional Risk Score
end note

@enduml
